<div class="d-flex align-items-stretch mb-2">
    <ion-button class="no-shadow mr-3 ion-button-m-0" color="tertiary" (click)="onClickPost()">
      <ion-icon slot="start" name="add"></ion-icon>
      <ion-text>CREATE POST</ion-text>
    </ion-button>
  <div class="flex-center px-2 w-100 bg-light fs-80 text-muted">
    <span>FORUM</span>
    <ion-icon class="mx-2" name="play"></ion-icon>
    <span>{{ philgo.forumName(forum?.post_id)}}</span>
  </div>
</div>

<ng-container  *ngFor="let post of posts">

  <ion-list class="mb-0">

    <ion-item routerLink="#"  (click)="onView( post ) ">
      <ion-avatar slot="start">
        <img [src]="philgo.primaryPhotoUrl( post?.member?.idx_primary_photo )">
      </ion-avatar>
  
      <ion-label class="d-md-flex align-items-center justify-content-between my-1" text-wrap>
        <h2 class="flex-1">{{ post.subject }}</h2>
        <p class="fs-sm my-md-0 ml-md-2">
          <span class="mr-3 darkgreen" *ngIf=" post?.member "> {{ post?.member?.nickname }}</span>
          <span>Date: {{ philgo.shortDate(post.stamp ) }}</span>
        </p>
      </ion-label>
    </ion-item>
    
  
    <ion-item *ngIf=" show(post) ">
      <ion-card class="no-shadow mb-1">
        <ion-card-content class="p-0">
          <div [innerHTML]="post?.content"></div>
          <app-files-component *ngIf="post.files.length" class="d-block pt-2 pb-1" [post]=" post "></app-files-component>
        </ion-card-content>
      </ion-card>
    </ion-item>
  
  
    <ion-item *ngIf=" show( post ) ">
  
      <ion-buttons class="d-block">
  
        <ion-button [attr.color]=" post.good == '0' ? 'medium' : 'primary'" (click)=" onVote( post, 'good' ) ">
          <ion-icon slot="start" name="thumbs-up"></ion-icon>
          <ion-text> {{ post.good == '0' ? '' : ' ' + post.good }}</ion-text>
        </ion-button>
  
        <ion-button color="medium" (click)=" onVote( post, 'bad' ) ">
          <ion-icon slot="start" name="thumbs-down"></ion-icon>
          <ion-text> {{ post.bad == '0' ? '' : ' ' + post.bad }}</ion-text>
        </ion-button>
  
        <ion-button color="medium" (click)=" onReply( post, post ) ">
          <ion-icon slot="start" name="text" mode="ios"></ion-icon>
          <ion-text>Reply</ion-text>
        </ion-button>

        <ion-button (click)=" onClickMenu( $event, post ) ">
          <ion-icon slot="icon-only" name="more" mode="ios" ></ion-icon>
        </ion-button>

      </ion-buttons>
  
    </ion-item>
  
    <!-- {{ post.comments | json }} -->
  
  
    <ion-list class="comments comments-depth bg-light pt-2" *ngIf=" post?.comments?.length && show(post) " >
      <ion-item class="comment" *ngFor=" let comment of post.comments " [attr.depth]=" comment.depth ">
        <ion-card class=" no-shadow p-0 mb-0 ml-1 w-100">
          
          <div>No. {{ comment.idx }}</div>
          <ion-card-content class="pb-0">
            <div [innerHTML]="comment.content"></div>
            <app-files-component *ngIf="comment.files.length" class="d-block pt-2 pb-1" [post]=" comment "></app-files-component>
          </ion-card-content>
  
          <ion-buttons class="d-block">
            <ion-button [attr.color]=" comment.good == '0' ? 'medium' : 'primary'"  (click)=" onVote( comment, 'good' ) ">
              <ion-icon slot="start" name="thumbs-up"></ion-icon>
              <ion-text>{{ comment.good == '0' ? '' : ' ' + comment.good }}</ion-text>
            </ion-button>
  
            <ion-button color="medium" (click)=" onVote( comment, 'bad' ) ">
              <ion-icon slot="start" name="thumbs-down"></ion-icon>
              <ion-text> {{ comment.bad == '0' ? '' : ' ' + comment.bad }}</ion-text>
            </ion-button>
  
            <ion-button  color="medium" (click)=" onReply( comment, post ) ">
              <ion-icon slot="start" name="text" mode="ios"></ion-icon>
              <ion-text>Reply</ion-text>
            </ion-button>

            <ion-button (click)=" onClickMenu( $event, comment ) ">
              <ion-icon slot="icon-only" name="more" mode="ios" ></ion-icon>
            </ion-button>

          </ion-buttons>
        </ion-card>
      </ion-item>
    </ion-list>
  
  </ion-list>
</ng-container>


<div class="text-center py-3 text-muted" *ngIf=" noMorePosts ">
  {{ philgo.t({ en: 'There is no more posts.', ko: '더 이상 글이 없습니다.' })}}
</div>

<ion-infinite-scroll class="mt-3" (ionInfinite)="loadPage($event)">
  <ion-infinite-scroll-content loadingSpinner="bubbles" loadingText="Loading more data...">
  </ion-infinite-scroll-content>
</ion-infinite-scroll>